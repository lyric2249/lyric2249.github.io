---
sort: 3
---

# Advanced MCMC

## Introduction

### Simulated Tempering

분포 $$f(x) \propto \exp \left(-H(x) \right), x \in X$$ 에서 샘플링하는데에 관심이 있다고 하자. simulated annealing에서 그러했던 것처럼, simulated tempering $$f(x, T) \propto \exp \left( -\dfrac {H(x)} {T} \right)$$로 타겟 분포를 확장시켰다. 이는 auxilary variable인 temperture $$T$$를 포함함으로서 이루어진다. $$T$$는 사용자가 미리 지정한 값들의 finite set이 된다.

$$U(0,1)$$에서 랜덤하게 숫자를 뽑고, $$j$$의 값을 proposal transition matrix $$(q_{ij})$$에 따라서 정한다.
* if $$j=i_t$$, let $$i_{t+1}=i_t$$, and let $$x_{t+1}$$을 MH kernal $$K_{i_t}(x,y)$$에서 뽑는다. 이때 $$K_{i_t}(x,y)$$는 $$f(x, T_{i_t})$$을 invariant distribution로 허용하는 아이이다.
* if $$j /not= i_t$$, let $$i_{t+1}=x_t$$하고 proposal을 이하의 $$Pr$$에 따라 채택한다. 이때 $$Z$$는 $$Z_i$$의 측정값이다. 채택된다면 $$i_{t+1} = j$$이고, 그외의 경우에는 $$i_{t+1} = i_t$$로 한다.
$$
\min \left[ 

1,

\dfrac {\hat Z_j} {\hat Z_{i_t}} \exp \right \{

-H(x) \left( \dfrac{1}{T_j}-\dfrac{1}{T_{i_t}} \right)

\left \}

\dfrac {q_{j,i_t}}, {q_{i_t , j}}

\right]
$$

Issues on Simulated Tempering
1. **Temperature Ladder를 어떻게 고를 것인가.** 
	* 가장 높은 온도 $$T_1$$은 대부분의 uphill move가 해당 레벨에서 accept 될 수 있도록 설정되어야 한다. 
	* 사이의(intermediate) 온도들은 sequential manner로 설정될 수 있다. $$T_1$$에서 시작해서, 점차적으로 다음으로 낮은 온도를 $$Var_i \left( H(x) \right) \ast \delta^2 = O(1)$$을 만족하도록 설정하는 것이다. 이때 $$\delta = \dfrac {1}{T_{i+1} - \dfrac{1}{T_i}$$이며, $$\Var_i(\cdot)$$은 $$H(x)$$ (taken with respect to $$f(x, T_i)) 의 분산을 의미한다.
		* 이러한 조건들은 $$f(x,T_i), f(x,T_{i+1})$$ 사이에 상당히 겹치는 점이 많아야 한다는 것을 의미하기도 한다. 실전에선 $$Var_i \left H(x) \right)$$는 샘플러를 레벨 $$T_i$$에서 예비적으로(preliminary) 돌려보았던 결과에서 러프하게나마 예측될 수 있다.       
2. **$$Z_i$$를 어떻게 estimate 할 것인가.** 이는 simulated tempering의 효율에 직결되는 부분이다. $$Z_i$$들이 잘 estimate 되었다면, simulated tempering은 temperature ladder을 따라 **symmetric RW**처럼 동작한다. ($$x$$-updating step을 제하고 볼 경우) 그렇지 않다면 이는특정 temperature 레벨에서 멈춰버린다. 시뮬레이션이 실패함은 물론이다(rendering). 실전에서 $$Z_i$$들은 stochastic approximationMC 방법론을 사용해서 estimate 가능하다. 혹은 reverse logistic regression 방법론을 사용해서도 $$Z_i$$를 estimate 할 수 있다.




### Slice Sampler

density $$f(x), x \in \chi$$에서 샘플링하고자 한다. $$ x \sim f(x)$$에서 샘플링하는 것은, $$f(x)$$ 그래프 이하의 영역에서 uniform하게 샘플링하는 것과 동등하다.  해당 영역은 $$A = \{ (x,u): 0 \le u \le f(x) \}$$이며, 이것이 acceptance-rejection 알고리즘의 기초(basis)였다. 이 목적을 달성하기 위해 우리는 타겟분포 $$f$$를 auxiliary variable $U$를 사용하여 확장해볼 수 있다. 이 $U$는, $$x$$에 대해서 조건부일 때, 구간 $$[0, f(x)]$$에서 uniform하게 분포되어 있다.



















## Multimodal Target Distribution





















































































































